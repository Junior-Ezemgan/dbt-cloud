version: 2

models: 
  - name : stg_payments
    columns :
      - name: payment_id
        description: Primary key for payment
        tests:
          - not_null
          - unique
      - name: amount
        description: amount fiels
        tests:
          - average_dollars_spent_greater_than_one:
              group_by_column: payment_id
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0 
              row_condition: "payment_id is not null" 
              strictly: false 
          - dbt_expectations.expect_column_mean_to_be_between:
              min_value: 1 # (Optional)
              group_by: [order_id] # (Optional)
              row_condition: "payment_id is not null" # (Optional)
              strictly: false
              config: 
                store_failures: true

                      
          
      